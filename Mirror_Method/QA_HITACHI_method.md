

# **磁気飽和とクラーク変換を利用した初期位置推定の理論的・数学的解説**

## **第1章 基礎原理：回転子位置情報はいかにして磁気飽和に符号化されるか**

永久磁石同期モータ（PMSM）の初期位置を電気信号のみから推定する技術は、物理現象を巧みに利用して情報を抽出する信号処理の好例である。本報告書で解説する手法の根幹には、回転子の静的な物理特性（角度）を、動的で測定可能な電気信号に変換するという考え方がある。この変換を可能にする物理現象が「磁気飽和」である。

### **1.1 永久磁石同期モータにおける磁気飽和の物理**

埋込磁石型同期モータ（IPMSM）の内部には、主に二つの磁束が存在する。一つは回転子に埋め込まれた永久磁石が生成する磁石磁束（ϕm​）であり、もう一つは固定子巻線に電流を流すことで発生する電流誘起磁束（ϕi​）である 1。モータの鉄心内では、これらの磁束がベクトル的に重ね合わされる。

この手法の核心は、参照文献の図4に示される磁束の相互作用にある 1。

* **磁束が強め合う場合（図4(a), (f)）**: 特定の固定子巻線に印加された電圧パルスが生成する電流誘起磁束 ϕi​ の向きが、その位置にある磁石磁束 ϕm​ の向きと一致する場合、鉄心内の合成磁束密度は著しく増加する。鉄などの強磁性体には磁束密度の限界（飽和磁束密度）があり、これに近づくと透磁率 μ （磁束の通りやすさ）が急激に低下する。この現象が磁気飽和である。インダクタンス L は透磁率 μ に比例するため、磁気飽和が発生するとその部分のインダクタンスは局所的に低下する。  
* **磁束が弱め合う場合（図4(b)）**: 電流誘起磁束 ϕi​ が磁石磁束 ϕm​ と逆向きになる場合、合成磁束密度は減少し、鉄心は磁気的に不飽和な状態を保つ。その結果、インダクタンスは高い値を維持する。

この物理現象から導かれる重要な結論は、回転子がインダクタンスの「変調器」として機能するという点である。永久磁石は回転子に固定され、固定子巻線は空間に固定されている。したがって、回転子の角度によって、どの固定子巻線が永久磁石のN極と最も強く正対するかが決まる。特定の相に電圧を印加した際に生じる磁気飽和の度合い、ひいてはインダクタンスの値は、回転子の角度によって直接的に変調される。このようにして、回転子の物理的な位置情報が、三相巻線の電気的特性に「刻印」されるのである。この位置に依存するインダクタンスの変化こそが、我々が測定すべき「信号」となる。

### **1.2 電圧パルス印加法**

この位置情報が刻印されたインダクタンスを読み出すために、参照文献では図3に示される電圧パルス印加法が用いられる 1。この手法では、u, v, wの各相に、正方向と負方向の短い電圧パルスを順次印加する。

電圧、インダクタンス、電流の関係は、基本的な物理法則 V=L(di/dt) で記述される。これを変形すると di=(V/L)dt となる。つまり、一定の電圧パルス（Vとdtが一定）を印加した場合、観測される電流のピーク値（diに相当）は、その時のインダクタンス L に反比例する。

この一連の因果関係を整理すると以下のようになる。

1. 回転子の位置が、ϕm​ と ϕi​ の向きの相関を決定する。  
2. その相関が、磁気飽和の度合いを決定する。  
3. 磁気飽和の度合いが、通電された相の効果的なインダクタンス L を決定する。  
4. インダクタンス L が、固定電圧パルスに対する電流応答のピーク値 ipeak​ を決定する。

したがって、各相のピーク電流を測定することは、間接的に回転子の位置を測定することに等しい。次の課題は、この測定値からいかにして角度情報を定量的に抽出するかである。

## **第2章 飽和の定量化：生電流から三相位置信号へ**

前章で確立した物理原理に基づき、本章では測定された6つの電流ピーク値（iu+​,iu−​,iv+​,iv−​,iw+​,iw−​）を、式(4)～(6)を用いて3つの飽和指標（Pu−​,Pv−​,Pw−​）に変換するプロセスを詳細に解説する。この変換は、単なる計算ではなく、信号から不要な成分を除去し、必要な情報だけを抽出するための重要な信号処理ステップである。

### **2.1 差動測定の論理的根拠**

参照文献の式(4)～(6)は以下のように定義されている 1。

$$P\_{u}^{-}=|i\_{u}^{+}|-|i\_{u}^{-}|$$$$P\_{v}^{-}=|i\_{v}^{+}|-|i\_{v}^{-}|$$$$P\_{w}^{-}=|i\_{w}^{+}|-|i\_{w}^{-}|$$

この引き算（差動測定）は、永久磁石の極性の影響を分離するために意図的に設計されたものである。  
正の電圧パルスを印加した際の電流 ∣i+∣ と負の電圧パルスを印加した際の電流 ∣i−∣ の差を取ることで、磁石の極性によって生じる飽和の「非対称性」を抽出できる。例えば、ある相がN極と正対している場合を考える。正パルス印加時は磁束が強め合い、強い磁気飽和が生じるため、インダクタンスは低く、電流 ∣i+∣ は大きくなる。一方、負パルス印加時は磁束が弱め合い、飽和は生じにくいため、インダクタンスは高く、電流 ∣i−∣ は小さくなる。その結果、差である P− は大きな正の値となる。

逆に、その相がS極と正対している場合は、この関係が逆転し、P− は大きな負の値となる。また、磁石の軸と直交する位置にある相では、正負どちらのパルスを印加しても飽和の度合いはほぼ同じであるため、∣i+∣ と ∣i−∣ は近しい値となり、P− はゼロに近くなる（図4(c), (d)参照）1。

したがって、P− という量は、単なる飽和の指標ではなく、磁石の極性によって引き起こされる飽和の非対称性を定量化するものである。P− の符号は、その相がN極とS極のどちらに面しているかを直接的に符号化している。

### **2.2 平衡三相システムの出現**

参照文献では、Pu−​,Pv−​,Pw−​ は互いに 2π/3 rad（120度）の位相差を持つと述べられている 1。これは、固定子のu, v, w相巻線が物理的に120電気角ずつずれて配置されていることに起因する。回転する磁石によって引き起こされる磁気飽和の効果は、この物理的配置を反映し、結果として

Pu−​,Pv−​,Pw−​ は、それぞれが120度ずつ位相がずれた3つの正弦波状の信号群として現れる。

結論として、巧妙なパルス印加と差動電流測定を通じて、我々は3つの電気量（Pu−​,Pv−​,Pw−​）を工学的に合成した。この信号群は、あたかも平衡三相交流システムのように振る舞い、その「位相」は回転子の電気角と直接的に同期している。これにより、回転子の位置を特定するという問題は、この合成された三相信号の位相角を求めるという、より扱いやすい信号処理の問題に帰着されたのである。

## **第3章 クラーク変換（式(7)）：包括的な数学的・幾何学的解説**

本章は、利用者からの問い合わせの中核である式(7)に焦点を当て、その導出と理論的背景を多角的に解説する。この式はクラーク変換として知られ、モータ制御理論における基本的な数学的ツールである。

### **3.1 モータ制御における座標変換の目的**

現代のモータ制御、特にベクトル制御（界磁方向制御）では、相互に干渉し合う三相の交流電流を直接制御することは困難である 2。制御の目標は、これらの交流量を、トルク成分と磁束成分を表す等価な直流量に変換することにある。これにより、単純なPI（比例積分）制御器を用いて、トルクと磁束を独立かつ高精度に制御することが可能になる 3。

クラーク変換は、このプロセスの最初のステップを担う。この変換は、Pu−​,Pv−​,Pw−​ のような平衡した時間変化する三相システムを、静止した直交二次元座標系（αβ座標系）における単一の回転ベクトルとして表現するものである 3。これにより、3つの変数を管理する問題が、1つのベクトル（2つの変数）を管理する問題へと劇的に単純化される。

### **3.2 クラーク変換行列の幾何学的導出**

式(7)の変換行列は、幾何学的な射影の概念から直感的に導出できる。まず、α軸をu相の物理的な軸と一致させた二次元平面を考える。このとき、v相の軸は120度、w相の軸は240度（-120度）の方向に位置する。Pu−​,Pv−​,Pw−​ の値は、これら3つの軸に沿ったベクトルの大きさと見なすことができる。我々が求めたいのは、これら3つのベクトルの合成ベクトルの、直交する$\\alpha軸と\\beta$軸上での成分である。

* Pα​ の導出:  
  合成ベクトルの$\\alpha軸への射影は、各相ベクトルの\\alpha$軸への射影の総和となる。  
  * Pu−​ の$\\alpha$軸への射影: Pu−​×cos(0∘)=Pu−​  
  * Pv−​ の$\\alpha$軸への射影: Pv−​×cos(120∘)=−0.5×Pv−​  
  * Pw−​ の$\\alpha$軸への射影: Pw−​×cos(240∘)=−0.5×Pw−​  
    これらを合計すると、Pα​∝Pu−​−0.5Pv−​−0.5Pw−​ となり、これは式(7)の行列の1行目に一致する 1。  
* Pβ​ の導出:  
  同様に、β軸（α軸から90度の方向）への射影を計算する。  
  * Pu−​ の$\\beta$軸への射影: Pu−​×cos(90∘)=0  
  * Pv−​ の$\\beta$軸への射影: Pv−​×sin(120∘)=(3​/2)×Pv−​  
  * Pw−​ の$\\beta$軸への射影: Pw−​×sin(240∘)=−(3​/2)×Pw−​  
    これらを合計すると、Pβ​∝0×Pu−​+(3​/2)Pv−​−(3​/2)Pw−​ となり、これは式(7)の行列の2行目に一致する 1。

### **3.3 形式的な代数表現**

上記の幾何学的導出は、以下の行列形式で代数的に表現される。

\[Pα−​Pβ−​​\]=C\[10​−1/23​/2​−1/2−3​/2​\]​Pu−​Pv−​Pw−​​​  
ここで、C は正規化のための係数である。この式は、前節で説明した幾何学的射影の操作を形式化したものに他ならない。

### **3.4 係数 2/3 の重要性（振幅不変変換）**

式(7)に現れる係数 2/3 は、正規化のために導入される 1。クラーク変換には、主に「振幅不変（amplitude-invariant）」と「電力不変（power-invariant）」の二つの形式が存在する 6。どちらを選択するかによって、変換後の$\\alpha\\beta$ベクトルの大きさが変わる。

振幅不変変換は、変換後の空間ベクトルの大きさ (Pα−​)2+(Pβ−​)2​ が、元の三相信号の振幅（ピーク値）と等しくなるように設計される。この条件を満たすために必要な係数が 2/3 なのである。

具体的には、平衡した正弦波入力、例えば Pu−​=Acos(θ), Pv−​=Acos(θ−120∘), Pw−​=Acos(θ+120∘) を、係数 2/3 を含んだ完全な式(7)に代入すると、三角関数の加法定理を用いて Pα−​=Acos(θ) および Pβ−​=Asin(θ) となることが証明できる。このとき、変換後のベクトルの大きさは (Acosθ)2+(Asinθ)2​=A となり、元の信号の振幅 A と一致する。

参照文献の著者が振幅不変変換を選択したのは、論理的かつ標準的な判断である。これにより、変換後の$\\alpha\\beta$座標系におけるベクトルの大きさが、入力信号の物理的なスケールと一致するため、制御システムの調整や解析が簡素化される。

## **第4章 統合：αβベクトルから最終的な角度推定値へ**

これまでの章で解説した要素を統合し、「なぜ式(7)が機能するのか」という問いに対する最終的な答えを導き出す。

### **4.1 回転子位置のスナップショットとしての$\\alpha\\beta$ベクトル**

これまでの議論で、以下の点が明らかになった。

1. 信号群 (Pu−​,Pv−​,Pw−​) は、その位相角が回転子の位置 θ に等しい三相システムである。  
2. クラーク変換（式(7)）は、この三相システムを単一の二次元ベクトル (Pα−​,Pβ−​) に変換する。

ここで最も重要な点は、クラーク変換が入力信号の持つ位相情報を完全に保存するということである。したがって、変換後のベクトル (Pα−​,Pβ−​) の$\\alpha\\beta$平面上での角度は、元の三相信号の位相角と同一になる。このベクトルは、静止座標系における回転子の磁界方向を捉えた「スナップショット」あるいは静的な表現と見なすことができる。

### **4.2 逆正接関数による角度の抽出**

最終的な角度の計算は、式(8)によって行われる 1。

θsat​=tan−1Pα−​Pβ−​​

これは基本的な三角法である。成分が (x,y) で与えられるベクトルの、x軸に対する角度は atan2(y,x) で求められる。式(8)は、この基本原理を適用したものである。  
以上をまとめると、初期位置推定の完全な論理連鎖は以下のようになる。

1. 回転子の物理的な位置が、各相のインダクタンスを物理的に変調する。  
2. 電圧パルスの印加と差動電流測定により、このインダクタンス変調が、位相角が回転子角度に等しい平衡三相システム (Pu−​,Pv−​,Pw−​) に変換される。  
3. \*\*式(7)（クラーク変換）\*\*は、この三相システムを、重要な位相情報を保持したまま単一の二次元空間ベクトル (Pα−​,Pb​eta−) に変換するための、特定の数学的ツールである。  
4. \*\*式(8)（逆正接関数）\*\*は、その二次元ベクトルの成分から角度を抽出するための、標準的な数学的操作である。

## **第5章 詳細分析：従来手法の限界と誤差要因**

専門的な報告書は、手法がどのように機能するかを説明するだけでなく、その弱点を批判的に分析する必要がある。この分析は、参照文献で提案されている改良手法の文脈を理解する上で重要であり、主題に対する深い理解を示すものである。

### **5.1 非正弦波状飽和と高調波の影響**

本手法の理論全体は、P− 信号が純粋な正弦波であるという理想的な仮定に基づいている。しかし、高性能モータでは、d軸とq軸間の磁気的な相互干渉（クロスカップリング）や複雑な鉄心形状により、磁気飽和の効果は完全な正弦波にはならない 1。

参照文献の図14および図15の分析から、この問題点が明確になる 1。従来手法で得られる

Pα−​ および Pβ−​ 信号には、無視できないレベルの5次および7次高調波成分が含まれている（Pα−​ ではそれぞれ1.91%, 3.81%）。クラーク変換は線形演算であるため、基本波成分だけでなく、これらの高調波成分も同様に変換する。その結果、得られる Pα−​ と Pβ−​ は、回転子角度 θ の純粋な正弦・余弦関数ではなく、歪んだ波形となる。

この歪んだ信号を互いにプロットすると、その軌跡は真円ではなく、波打った形状になる。真円を前提とする tan−1 による角度計算は、この歪みのために真の角度からのずれを生じさせる。この誤差は高調波の周波数で周期的に現れ、図13に示される従来手法の周期的な誤差プロファイルの直接的な原因となる 1。

### **5.2 電流センサのオフセット誤差に対する脆弱性**

参照文献は、電流センサのオフセット誤差が従来手法の問題点であることを明確に指摘している 1。この誤差の伝播メカニズムは、差分計算に起因する。

オフセット誤差 Δi が存在する場合、測定される電流は imeas​=itrue​+Δi となる。従来手法の差分計算 P−=∣imeas+​∣−∣imeas−​∣ では、このオフセット項 Δi は相殺されず、誤差として$P^-$信号に残留する傾向がある 1。特に、三相のセンサ間でオフセットがわずかでも異なると（これは現実的なシナリオである）、その差分オフセットはクラーク変換後もキャンセルされず、$\\alpha\\beta$平面上に一定の誤差ベクトルを生じさせる。この誤差ベクトルは、本来原点にあるべき空間ベクトルの回転中心をずらし、位置に依存した大きな角度誤差を引き起こす。

対照的に、参照文献の提案手法で用いられる和の計算 P+=∣i+∣+∣i−∣ は、この問題に対してより堅牢である。対称的なオフセット誤差は和を取る過程で自然に相殺されるため、センサオフセットに対する耐性が向上する 1。

### **5.3 異なるモータタイプ（SPMSM）への適用性**

参照文献の結論部では、本手法が表面磁石型同期モータ（SPMSM）のような突極性（インダクタンスの異方性）が小さいモータには適さないと述べられている 1。この記述は、手法の適用限界を理解する上で重要である。

提案手法は、P+=∣i+∣+∣i−∣ という和の計算に依存している。この計算は、磁気飽和の影響を相殺し、d軸とq軸のインダクタンス差、すなわち「突極性」に起因する成分を抽出する。SPMSMでは、Ld​≈Lq​ であるため突極性がほとんどなく、P+ 信号はほぼ一定値となり、位置情報を含まない。

一方で、本報告書の主題である従来手法は、磁気飽和の「非対称性」を利用する。磁気飽和は永久磁石の磁束が存在すればSPMSMでも発生するため、従来手法は理論上、SPMSMでもある程度機能する可能性がある。したがって、参照文献の結論は主に提案手法の限界を指しているが、この比較を通じて、従来手法と提案手法がそれぞれ異なる物理原理に基づいていることが浮き彫りになる。

以下の表は、本報告書で分析した従来手法と、参照文献で提示された提案手法の比較をまとめたものである。

| 特徴 | 従来手法（式4-6） | 提案手法（式9-11） |
| :---- | :---- | :---- |
| **計算方法** | 差分: P−=∥i+∥−∥i | 和: P+=∥i+∥+∥i |
| **利用する主たる物理原理** | 磁気飽和の非対称性 | 突極性（平均インダクタンス） |
| **符号化される情報** | 回転子の位置 **および** 極性（1周期信号） | 回転子の位置（極性なし、2周期信号） |
| **高調波に対する脆弱性** | **高い**。非正弦波状飽和が信号を歪ませ、誤差の原因となる 1。 | **低い**。和の計算により飽和に起因する奇数次高調波が相殺され、よりクリーンな突極性信号が抽出される。 |
| **センサオフセットへの脆弱性** | **高い**。オフセット誤差が差分計算を通じて伝播し、バイアスを生む 1。 | **低い**。和の計算により対称的なオフセット誤差が自然に相殺される。 |

## **第6章 結論**

本報告書は、参照文献に示された初期位置推定法における式(7)が、標準的な振幅不変クラーク変換であることを示した。その導出は、三相ベクトルシステムを二相直交基底へ幾何学的に射影するという概念に根差している。

この式が機能する根源的な理由は、その前段で行われる信号処理、すなわち電圧パルス印加と差動電流測定が、モータの磁界を代理する信号群 (Pu−​,Pv−​,Pw−​) を巧みに合成することにある。この信号群は、その位相角が回転子の物理的な位置を直接表現する平衡三相システムとして振る舞う。クラーク変換は、この三相表現を、角度情報を完全に保持したまま単一の二次元ベクトルに変換する、不可欠な数学的架け橋の役割を果たす。そして最終的に、逆正接関数によってそのベクトルから角度が容易に抽出されるのである。

結論として、クラーク変換自体は標準的なツールであるが、この手法の真の独創性は、それに至るまでの信号工学にあると言える。最終的な推定精度の良し悪しは、変換そのものよりも、変換器に入力される信号の忠実度に大きく依存する。非正弦波状飽和による高調波や電流センサのオフセットといった誤差要因が、実用化における重要な課題となるのは、まさにこのためである。

#### **引用文献**

1. HITACHI\_sensorless.pdf  
2. ブラシレスDC（BLDC）モーターの原理とそれらを使用する正しい方法 \- HOLRY MOTOR, 6月 19, 2025にアクセス、 [https://www.holrymotor.com/ja/principles-of-brushless-dc-bldc-motors-and-the-correct-way-to-use-them.html](https://www.holrymotor.com/ja/principles-of-brushless-dc-bldc-motors-and-the-correct-way-to-use-them.html)  
3. ベクトルエンジンとベクトル制御 | 東芝デバイス＆ストレージ株式 ..., 6月 19, 2025にアクセス、 [https://toshiba.semicon-storage.com/jp/semiconductor/knowledge/e-learning/village/vector-1.html](https://toshiba.semicon-storage.com/jp/semiconductor/knowledge/e-learning/village/vector-1.html)  
4. オシロスコープによる 三相モータのドライブ回路測定 \- Tektronix, 6月 19, 2025にアクセス、 [https://www.tek.com/-/media/files/jp-documents/3-phase\_motor\_drives\_w\_oscilloscope\_48z-73863-1.pdf](https://www.tek.com/-/media/files/jp-documents/3-phase_motor_drives_w_oscilloscope_48z-73863-1.pdf)  
5. Gowin FOC Current Loop Control Light IP \- ユーザーガイド, 6月 19, 2025にアクセス、 [https://www.gowinsemi.com/upload/database\_doc/1428/document\_ja/6073c68488a28.pdf](https://www.gowinsemi.com/upload/database_doc/1428/document_ja/6073c68488a28.pdf)  
6. Sensorless Field Oriented Control of PMSM Based ... \- ČVUT DSpace, 6月 19, 2025にアクセス、 [https://dspace.cvut.cz/bitstream/handle/10467/114965/F3-DP-2024-Slehofer-Kristian-Sensorless\_Field\_Oriented\_Control\_of\_PMSM\_Based\_on\_STSPIN32G4.pdf?sequence=-1\&isAllowed=y](https://dspace.cvut.cz/bitstream/handle/10467/114965/F3-DP-2024-Slehofer-Kristian-Sensorless_Field_Oriented_Control_of_PMSM_Based_on_STSPIN32G4.pdf?sequence=-1&isAllowed=y)  
7. Design and Control of Electrically Excited Synchronous Machines ..., 6月 19, 2025にアクセス、 [https://research.chalmers.se/publication/522780/file/522780\_Fulltext.pdf](https://research.chalmers.se/publication/522780/file/522780_Fulltext.pdf)  
8. Vibration Attenuation for Satellite Reaction Wheels through the use of Field-Oriented Control, 6月 19, 2025にアクセス、 [https://lup.lub.lu.se/student-papers/record/9040710/file/9040718.pdf](https://lup.lub.lu.se/student-papers/record/9040710/file/9040718.pdf)