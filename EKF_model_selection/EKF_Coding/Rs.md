承知しました。PMSMを対象としたRs（固定子抵抗）の推定をEKFの外部で行うアプローチに関する学術論文（日本語・英語問わず）を調査します。

代表的な推定法（RLS、信号注入法、低速状態での同定など）とその実装例を含むものを優先的に探します。しばらくお待ちください。


## MRAS（モデル参照型適応システム）による抵抗オンライン推定

PMSMモデルを用いたMRAS型オブザーバで、回転速度と抵抗を同時に推定する手法です。典型的には、モータ電流のモデル出力と実測値の誤差をPI制御などでゼロにする適応則を設け、抵抗\$R\_s\$をリアルタイム補正します。Chenら(2023)はMRASオブザーバに抵抗同定機能を組み込み、インバータデッドタイム補償も追加することで低速域での推定精度向上を報告しています。これによりモータ抵抗を1.68Ωから3Ωへ段階的に変化させるシミュレーションで、補償無しでは定常誤差17%だった抵抗推定誤差が補償適用後は1.6%程度まで低減し、速度推定誤差も大幅に改善されています。必要な信号はステータ電流（電流センサ）と印加電圧（電圧指令値や直流リンク電圧）で、回転センサレス構成の場合でも低速・負荷状態で安定に機能するよう設計されています。メリットは**抵抗値のリアルタイム補償**によって温度上昇時のオブザーバ精度低下を防ぎ、**低速域での位置・速度推定**やトルク制御の安定性が向上する点です。一方、**ゼロ速近傍ではMRAS単独では不可観測**となるため追加の信号注入等が必要となること、また**高回転・無負荷時は誤差信号が微小で推定感度が低下**するため適応則を停止・緩和する工夫が推奨されています。実装上はモータモデル精度や適応ゲイン調整が課題ですが、比較的簡易なPI制御型適応器で実現できる点も利点です。

* **概要:** モータ電流方程式を基にしたMRASオブザーバで、モデル出力と実測出力のずれから抵抗をオンライン同定。Chenらはデッドタイム影響を補償し低速センサレス性能を向上。
* **計測信号:** フィードバックに使うのは各相電流（dq変換）とインバータ電圧（指令値や直流電圧）。回転位置・速度センサは不要（センサレス）で、必要なら起動直後のみ初期位置検知策と併用。
* **適用条件:** **低速～中速域かつ負荷電流がある状態**で有効。極低速・停止時はMRASのみでは不可観測のため高周波注入等を併用。高速域では逆起電力が大きく抵抗推定精度が劣化しうるため、適応ゲイン低減や補正停止も検討。
* **メリット:** オンラインで**温度上昇に伴う抵抗変化を追従**可能となり、磁束推定やトルク制御の精度維持に寄与。センサレス制御での低速性能改善（例：MRASのみでは速度偏差50 r/minだったのが抵抗適応により2 r/min以内に収束）。アルゴリズムが比較的シンプルで既存FOCに組み込みやすい。
* **制約:** 抵抗と他パラメータ（インダクタンスや磁束）との同時推定は**可観測性の問題**があり工夫が必要（例えば磁束は別途EKFで推定し抵抗はMRASで推定する段階的同定）。モデル精度（デッドタイム補償や磁気飽和無視の前提など）に依存するため、非線形成分が大きい場合は精度低下。高周波ノイズや積分漂 drift の影響で安定同定にはゲイン調整やフィルタ処理が必要。

## RLS（再帰最小二乗法）によるオンラインパラメータ同定

制御工学で広く用いられるRLSアルゴリズムを用いて、モータの電気モデルから抵抗\$R\_s\$を推定する手法です。RLSは誤差最小化のためにパラメータを逐次更新するもので、**収束が速く実装が容易**なオンライン同定手法として知られています。PMSMの電圧方程式（例えば\$dq\$軸の\$V\_d = R\_s i\_d + L\_d \frac{di\_d}{dt} - \omega\_e L\_q i\_q + \cdots\$）における未知パラメータ\$R\_s\$を状態とみなし、電圧・電流・速度等の計測データから\$R\_s\$を逐次推定します。実時間で巻線抵抗の温度変化に追従するため、古いデータの影響を指数的に減衰させる**忘却係数\$\lambda\$**を用いるのが一般的です。忘却係数\$\lambda<1\$により直近のデータを重視して可変抵抗をトラッキングできますが、その値の選択は**収束速度とノイズ安定性のトレードオフ**となります。忘却係数を1に固定すると過去全データを均等に考慮するため定常精度は上がりますが、パラメータ変動への追従性がなくPMSMのような時変系には不向きです。一方で\$\lambda\$を小さくし過ぎるとノイズや負荷外乱で推定値が振動しやすくなる制約があります。最近の研究では、この係数をメタヒューリスティクス等で適応的に調整することでRLS推定精度を向上させる試みもあります。例えばWuら(2024)は**情報取得オプティマイザ(IAO)**なる手法で忘却係数を動的最適化し、RLS単独よりも抵抗・インダクンス推定精度を高めたと報告しています（提案手法は**IAORLS**と称され、従来RLSより収束が速く誤差が小さいことをシミュレーションで確認）。必要な信号はモータ電圧・電流および回転速度または角度（モデル式に含まれる項に応じて）です。RLSは観測データの励起が十分あれば**複数パラメータ同時同定**も可能であり、実機実験では5パラメータ（\$R\_s\$，\$L\_d\$，\$L\_q\$，トルク定数，慣性）を初期値ゼロから数秒程度で正しい値に収束させています。

* **概要:** モータの状態空間モデルあるいは回路方程式にRLSを適用し、誤差フィードバックで抵抗を逐次推定。温度変化などによる抵抗ゆっくり変動にも追従可。
* **計測信号:** 各相または\$dq\$軸電流・電圧指令値、および必要に応じて回転速度信号（モデル式に含める場合）。高精度には電圧センサで実際の端子電圧を読むのが望ましいが、インバータ非理想性を補償できれば指令値でも可。
* **適用条件:** モータに十分な**励起（エキサイテーション）がある運転状態**で有効。同定にはモデル式の行列のフルランク性が必要なため、定常状態（一定負荷・一定速度）では変化がなく識別困難です。したがって**電流や速度に変化のある過渡を利用**するか、小さなテスト信号を重畳する必要があります。例えば起動直後や負荷変動時に抵抗推定を行い、その結果を以降に反映する形でオンライン更新する実装も考えられます。
* **メリット:** **実装が比較的容易**（行列演算によるパラメータ更新のみ）で、適切な忘却係数のもとでは**収束が速い**。複数パラメータを同時に推定できる柔軟性があり、モータ定数の自己同定やコンディションモニタリングに有用。温度上昇による抵抗変化などゆるやかな時変にも追従可能で、**長期的なドリフト補償**に優れます。
* **制約:** RLSは**初期値依存性**や**ノイズ感度**があります。初期推定値を大きく外すと収束まで時間がかかったり一時的に発散しかける可能性もあります。そのため初期\$R\_s\$は事前測定値で初期化するのが望ましいです。また**忘却係数のチューニング**が難しく、小さすぎると推定値の揺らぎが大きくなり、逆に大きすぎるとパラメータ変化に追従できない。さらに、全ての運転領域で常に高精度とは限らず、**低速無負荷では興奮信号不足**、高速では逆起電力項の影響が大きく抵抗推定が不正確になる可能性があります。従ってRLS推定値を鵜呑みにせず、必要に応じフィルタ処理や他手法とのハイブリッドで信頼性を確保する設計も考慮されます。

## 適応オブザーバ（外部推定器）による抵抗推定

EKFに組み込まず、別途**適応型のオブザーバ**を設計して\$R\_s\$を推定するアプローチも盛んです。例えば**拡張状態オブザーバ(ESO)**や**適応ルーバーグ(Luenberger)オブザーバ**に抵抗推定のためのフィードバックを追加する方法です。Hinkkanenら(2010)は低次元の位置推定オブザーバに抵抗推定機構を組み込み、推定誤差の安定性解析とゲイン設計法を提示しています。彼らの適応則は「推定\$d\$軸磁気鎖交\$\hat\psi\_d\$と既知の永久磁石磁束\$\psi\_{pm}+L\_d i\_d\$との差」を利用し、その偏差が0となるよう\$R\_s\$を積分補正する形です。この適応オブザーバでは**電流センサとインバータ電圧**のみを用いて速度・位置と抵抗を同時推定しており、実験では2.2kWモータの巻線抵抗をスイッチで3Ω変化させるテストにおいて、数秒内に推定値が実値へ収束することが確認されています。また適応ゲインの符号や大きさを運転状況（電流ベクトルや推定速度）によって切替えることで、**全ての速度領域（ゼロ速度を除く）で局所安定**となる条件を導出しています。ただし著者らも指摘するように、**無負荷近傍や高速度域では信号対雑音比が悪化**し抵抗推定が難しくなるため、その場合は適応動作を停止またはゲイン低下させる措置を取っています。このような適応オブザーバ方式のメリットは、EKFより実装が簡潔で計算負荷も低く、既存のセンサレスオブザーバに抵抗推定を付加できる点です。さらに観測器内部で独立に抵抗を推定するため、**主系の制御や推定から分離**して安定性チューニングできる利点もあります（ユーザが懸念する「初期ばらつきや独立した制御性」を確保しやすい）。制約としては、設計に高度な非線形安定性理論（Lyapunov関数やPopov基準等）を用いる場合が多く、理論構築とゲイン調整が難しいこと、ゼロ速では他法に頼る必要があること、高速域での性能限界などがあります。代表例として上述のHinkkanen以外にも、一般化ESO＋抵抗適応を組み合わせた手法や、モデル誤差をオンラインで観測して抵抗補正する**スライディングモードオブザーバ＋抵抗推定**などが報告されています。これらは主にセンサレス制御下でパラメータずれに強い制御を実現する目的で使われます。

* **概要:** EKF外部に独立したオブザーバを設計し、電流観測とモデル誤差から抵抗を適応推定する方式。例：状態拡張型のLuenbergerオブザーバに抵抗補正項を追加。
* **計測信号:** ステータ電流（最低2相）とインバータ印加電圧。回転角・速度はオブザーバ内部で推定するため不要（センサレス）。なお初期位置だけは別途判明させる必要があります。
* **適用条件:** **ゼロ速度以外の広い範囲**で動作可。ただし高速度では抵抗項の影響が相対的に小さく推定感度低下。無負荷時（電流微少時）も同様に信号不足となるため、**ある程度の電流負荷がある状態**が望ましいです。ゼロ速スタートアップ時のみは別途高周波注入等で位置検知し、その後本オブザーバに切替える構成が考えられます。
* **メリット:** **センサレス環境下で抵抗変動にロバストな推定**が可能となり、低速高トルク領域での速度推定安定性が向上します。また、抵抗推定器をEKFなど主要な状態推定系から切り離せるため、**推定器間の相互干渉が少なく調整しやすい**という利点があります。温度上昇等による抵抗変化を逐次補償できるため、高精度な磁束/位置推定やトルク制御を長時間維持できます。
* **制約:** **設計とチューニングの複雑さ**が挙げられます。非線形システムに適応則を付加するため、収束安定性を保証する理論設計が必要で、実装者に高度な制御知識が要求されます。さらに**ゼロ速では原理的に推定不能**（逆起電力ゼロのため）であり、停止・極低速時の識別には別手段との併用が不可欠です。高回転域でも抵抗推定への寄与が微小となり実質的に精度が落ちるため、そこでの有効性は限定的です。オブザーバ内部モデルが不正確（インダクタンス変動や磁束値不明など）な場合、抵抗以外の不確かさを誤って抵抗推定値で補償してしまうリスクもあります。従って、適応オブザーバを用いる際は他のパラメータ推定や補償も組み合わせた**包括的なモデル補正戦略**が必要です。

## 信号注入法による抵抗推定

モータに小さな検出用信号（電圧・電流）を重畳し、その応答から巻線抵抗を推定する手法です。**トルクに影響を与えない注入手法**を工夫することで、負荷下や低速運転中でもリアルタイムに抵抗値を測定できます。Wilsonら(2010)は抵抗変化から**コイル温度を推定**する目的で、PMSMにおける2種類の電流注入法を提案しています。一つは電流ベクトルの位相（角度）を固定して高周波成分を注入する方式、もう一つは電流の大きさのみ変調する方式で、それぞれ\*\*“固定角注入”**と**“固定振幅注入”**と呼ばれます。さらに、これらの注入信号を通常の駆動電流から分離して検出するために、**“ユニポーラ/バイポーラ分離”**という2通りの手法も導入されました。要するに、一定のタイミングで正方向または双方向の小さな電流パルスを印加し、その応答電圧を解析して抵抗成分を抽出するものです。工夫されたポイントは、注入成分が**平均トルクに寄与しないようdq軸を選定**し、さらに注入データを処理して**逆起電力による電圧変動と抵抗電圧降下を識別**できるようにしている点です。これにより**モータのトルクや速度を乱さず**に抵抗を測定でき、実際の巻線温度上昇をリアルタイム監視できます。必要な信号は電流センサと高精度な電圧計測（または既知の注入電流値）です。例えば固定角\$d\$軸にDC電流オフセットを一瞬注入し、その電流減衰の時定数から\$R\_s\$を求めるといった実装が考えられます。この方法は**低速やゼロ速でも適用可能\*\*であり、特に通常のセンサレス制御ではパラメータ観測が困難な停止時において有効です。実際、Dilysら(2022)はモータ停止中に電圧パルスを3回印加して各相の電流ピークを測定することで\$dq\$軸インダクタンスを算出し、同時に電流の指数減衰曲線から抵抗を推定する手法を提案しています。この方法は初期位置を問わず実行でき、デッドタイムの影響も補正可能で、シンプルな手順ながら数ミリ秒程度で\$R\_s\$とインダクタンスが高精度に得られることを実証しています。

* **概要:** モータに意図的に小信号を印加し、その**応答波形からパラメータを測定**するアプローチ。トルクに影響しない高周波または特定軸への信号を用いる。
* **計測信号:** 三相電流センサおよびインバータ出力電圧の制御。高周波注入の場合は電流指令に高周波成分を重畳し、そのときの電圧・電流の関係を高速サンプリングで取得します。低周波（DC）注入の場合は一定電流を流し込み電圧降下を測定。**高分解能のAD変換**や高速サンプリングが要求されますが、最近のDSPで実現可能な範囲です。
* **適用条件:** **停止～低速域**で特に有効です。他法では観測困難なゼロ速でも、電流注入により抵抗を直接測定できます。また負荷トルクがかかった状態でも注入信号を工夫すればトルク脈動を生じないため、**運転継続中のパラメータ監視**が可能です。一方、高速域では高周波注入信号が他の高調波やノイズに紛れ検出精度が落ちる可能性があります。
* **メリット:** **極低速や停止状態でも高精度に抵抗を算出**できる点が最大の利点です。これにより起動前のパラメータキャリブレーションや、モータ停止中の**熱保護（コイル温度推定）**が可能となります。また動作中も微小信号であればトルクに影響せず**リアルタイムの健康監視**に利用できます。さらに逆起電力の変動と抵抗電圧降下を分離測定できるため、磁石減磁などで生じるEMF定数の変化と抵抗変化とを区別して診断できる利点も報告されています。
* **制約:** **追加の励振信号**が必要になるため、制御実装が複雑化します。注入周波数やパルス幅の選定、信号分離のフィルタ処理など、設計すべき事項が増えます。また微小信号を扱うため**測定ノイズの影響**を受けやすく、高精度なセンサとノイズフィルタリングが不可欠です。加えて、注入によりごく僅かながら追加損失や振動が発生する可能性もあります。ただしこれら制約は慎重な設計で緩和可能であり、信号注入法は信頼性の高いパラメータ同定手段として実用化も進んでいます。例えば一部のインバータ製品では、起動時に自動で巻線抵抗をインジェクションテストで測定し温度推定に反映する機能が実装されています。

## 静的オフライン同定とその他のアプローチ

モータを停止または低速一定条件で保持し、**オフラインで抵抗を測定**する古典的手法も有用です。最も単純には、モータ端子に直流電圧を印加して定常電流値から\$R\_s=V/I\$で算出する方法があります。この**直流試験**は容易ですが、インバータの電圧降下や温度安定までの待ち時間に注意が必要です。また高精度には四端子法など計測系の抵抗補正も要求されます。Dilysらのようにパルス注入を数回行ってパラメータを抽出する方法も広義にはオフライン同定に属し、短時間で実行できるため実装上有益です。オフライン同定はオンラインより**ノイズの少ない環境で高精度計測**ができる利点がありますが、一度測定した値はその後の温度変化等でずれていくため、適宜オンライン推定で補正する必要があります。

一方、近年では**データ駆動型**や**最適化アルゴリズム**を活用したパラメータ推定も研究されています。例えば、Adaline（適応線形ニューロン）ネットワークを用いてモータの状態偏差から抵抗を学習推定する手法や、粒子群最適化(PSO)アルゴリズムでモデルと実測の誤差を最小化して\$R\_s\$と他パラメータを同定する手法があります。Liuら(2015)はAdaline型ニューラルネットでセンサレスPMSMのわずかな位置オフセットからパラメータ変化（抵抗やインダクタンス）の兆候を捉えることで、温度上昇などによる特性変化を検出しています。Heら(2016)は**協調学習PSO**(CLPSO)にオポジション学習を加えた高度な最適化法で、PMSMの\$R\_s\$と磁極磁束を同時推定することに成功しています。これらモデルフリーに近いアプローチは、非線形飽和や温度依存など**モデル化が難しい影響も包含**して推定できる可能性があります。メリットは**パラメータ間の複雑な関係を自動で学習**できる点ですが、一方で十分な学習データや計算リソースが必要で、リアルタイム制御への適用には工夫が必要です。現状ではオフライン解析や予備的なパラメータ同定に用い、得られたモデルをオンライン制御にフィードバックする形が現実的ですが、将来的にはオンライン学習により温度特性まで自己補償する高度なドライブも研究が進むでしょう。

以上のように、PMSMの巻線抵抗\$R\_s\$推定には多彩な手法が存在します。それぞれ**必要なセンサ信号**や**適用可能な運転条件**、そして**メリット・デメリット**が異なるため、用途に応じた選択が重要です。ユーザーが懸念するように、EKFに組み込んでしまう方法は他状態との**同時推定の難しさ**や初期値依存の問題がありますが、今回紹介したような**外付けのR\_s同定アルゴリズム**（RLSや適応オブザーバ、信号注入等）を用いれば、それらの課題を回避しつつ高精度な磁束・温度推定に役立てることができます。各手法の知見を設計指針として、目的の精度と実装コストに見合った抵抗推定方式を検討されるとよいでしょう。
