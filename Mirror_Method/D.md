# D因子フィルタの主要な数式と定義

## 1. D因子 (D-factor) の定義

[cite_start]D因子は、ベクトル回転器同伴フィルタの周波数シフト特性を単一の$2 \times 2$行列で表現するために導入された概念です 。

* **定義式**

    $$
    D(s, \omega_{0}) = \begin{bmatrix} s & -\omega_{0} \\ \omega_{0} & s \end{bmatrix} = sI + \omega_{0}J
    $$
    -   `s`: ラプラス演算子
    -   [cite_start]`ω₀`: 外部から与えられる実数のシフト信号（角周波数） 
    -   `I`: 単位行列
    -   `J`: 交代行列 $\begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix}$

* **D因子の特性**

    D因子は、対角行列 $diag(s ± jω₀)$ と相似の関係にあります 。

$$D(s, \omega_{0}) = U \cdot \text{diag}(s+j\omega_{0}, s-j\omega_{0}) \cdot U^{\dagger}$$
    -   `U`: ユニタリ行列
    -   この関係により、D因子が周波数シフト機能を持つことが数学的に保証されます。

---
## 2. D因子フィルタ (D-Factor Filter) の定義

[cite_start]D因子フィルタは、通常のスカラフィルタの伝達関数 $F(s)$ のラプラス演算子 `s` を、D因子行列 $D(s, \omega_{0})$ に置き換えることで構成されます 。

* **定義式**

$$
    \tilde{y} = F(D(s, \omega_{0}))\tilde{u}
$$
    -   `F(s)`: 元となる1入力1出力のスカラフィルタ\（例: $$F(s) = \frac{B(s)}{A(s)}$$\） 
    -   `ũ`: 2相の入力ベクトル信号
    -   `ỹ`: 2相の出力ベクトル信号

* **周波数特性**

    D因子フィルタは、入力信号の正相成分と逆相成分に対して、それぞれ異なる伝達関数として作用します 。

    $$
    \tilde{Y}_{pn}(s) = \text{diag}(F(s+j\omega_{0}), F(s-j\omega_{0})) \tilde{U}_{pn}(s)
    $$
    -   正相成分には $F(s+j\omega_{0})$ が適用されます 。
    -   逆相成分には $F(s-j\omega_{0})$ が適用されます 。
    -   これにより、外部信号 `ω₀` によってフィルタの通過帯域を周波数軸上で自在に移動させることができます。

---
## 3. 逆D因子 (Inverse D-Factor) の実現

[cite_start]D因子フィルタをブロック線図で実現する際には、逆D因子 $D^{-1}(s, \omega_{0})$ の実現が重要になります 。

* **状態方程式**

    逆D因子は、次の簡単な状態方程式を解くことで実現できます 。

   
   $ s\tilde{y} = -\omega_{0}J\tilde{y} + \tilde{u}$
    -   この式は、積分器 $1/s$ とベクトル乗算器、加算器のみで構成できるため、実装が非常にシンプルです 。
    -   $Jỹ$ の演算は、単に信号要素の交代と符号反転だけで実現でき、特別な乗算器は不要です 。

* **伝達関数**

    $$
    \tilde{y} = D^{-1}(s, \omega_{0})\tilde{u} = \frac{1}{s^2+\omega_{0}^2} \begin{bmatrix} s & \omega_0 \\ -\omega_0 & s \end{bmatrix} \tilde{u}
    $$
    -   上記の伝達関数を行列のまま実装するよりも、状態方程式を離散化して実装する方が簡単で効率的です 。